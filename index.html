<!DOCTYPE html>
<html lang="ca">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>M√âS per Llucmajor - El futur que volem</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Fonts: Barlow s'assembla molt a Geogrotesque per a l'entorn web -->
    <link
      href="https://fonts.googleapis.com/css2?family=Barlow:ital,wght@0,400;0,600;0,700;0,800;1,700&display=swap"
      rel="stylesheet"
    />

    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ["Geogrotesque", "Barlow", "sans-serif"],
            },
            colors: {
              mes: {
                lime: "#c6d100", // Color oficial
                dark: "#1a1a1a", // Negre institucional
                gray: "#f4f4f4", // Gris clar
                text: "#333333",
              },
            },
          },
        },
      };
    </script>

    <style>
      body {
        font-family: "Barlow", sans-serif;
        color: #1a1a1a;
        scroll-behavior: smooth;
      }

      .bg-mes-lime {
        background-color: #c6d100;
      }
      .text-mes-lime {
        color: #c6d100;
      }
      .border-mes-lime {
        border-color: #c6d100;
      }

      .btn-primary {
        background-color: #c6d100;
        color: #1a1a1a;
        font-weight: 800;
        text-transform: uppercase;
        padding: 0.75rem 1.5rem;
        transition: all 0.2s ease;
        display: inline-flex;
        align-items: center;
        letter-spacing: 0.05em;
      }
      .btn-primary:hover {
        background-color: #1a1a1a;
        color: #c6d100;
      }

      .section-title-box {
        background-color: #1a1a1a;
        color: white;
        padding: 0.5rem 1rem;
        display: inline-block;
        font-weight: 800;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        margin-bottom: 1.5rem;
      }

      .chart-container {
        position: relative;
        width: 100%;
        max-width: 500px;
        margin: auto;
        height: 300px;
      }

      /* AI Chat UI */
      #ai-chat-window {
        display: none;
        position: fixed;
        bottom: 90px;
        right: 20px;
        width: 350px;
        height: 450px;
        z-index: 1000;
        flex-direction: column;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        border-radius: 12px;
        overflow: hidden;
        background: white;
        border: 2px solid #1a1a1a;
      }

      .chat-bubble-ai {
        background: #c6d100;
        color: #1a1a1a;
        align-self: flex-start;
        border-radius: 0 12px 12px 12px;
      }

      .chat-bubble-user {
        background: #f4f4f4;
        color: #1a1a1a;
        align-self: flex-end;
        border-radius: 12px 12px 0 12px;
      }

      .loading-dots:after {
        content: ".";
        animation: dots 1.5s steps(5, end) infinite;
      }
      @keyframes dots {
        0%,
        20% {
          content: ".";
        }
        40% {
          content: "..";
        }
        60% {
          content: "...";
        }
      }
    </style>

    <!-- 
    <!-- Chosen Palette: M√âS Corporativa (#c6d100 / #1a1a1a) -->
    <!-- Application Structure Plan: P√†gina √∫nica (SPA) amb seccions de not√≠cies, programa interactiu, visi√≥ pol√≠tica i b√∫stia de suggeriments. Incorpora assistent Gemini per a consultes i refinament de text. -->
    <!-- Visualization & Content Choices: Gr√†fics Chart.js per a prioritats, filtratge de not√≠cies din√†mic i xat flotant d'IA. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    -->
  </head>
  <body class="bg-white">
    <!-- Navegaci√≥ -->
    <nav
      class="fixed w-full z-50 bg-white border-b-4 border-mes-lime shadow-md"
    >
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-20">
          <div
            class="flex items-center cursor-pointer py-2"
            onclick="window.scrollTo(0,0)"
          >
            <!-- √ös del logo adjuntat -->
            <img
              src="image_5e196d.png"
              alt="M√âS per Llucmajor"
              class="h-14 w-auto"
            />
          </div>
          <div class="hidden md:flex space-x-8 items-center">
            <a
              href="#actualitat"
              class="font-bold text-sm uppercase tracking-widest hover:text-mes-lime transition-colors"
              >Actualitat</a
            >
            <a
              href="#visio"
              class="font-bold text-sm uppercase tracking-widest hover:text-mes-lime transition-colors"
              >Visi√≥</a
            >
            <a
              href="#programa"
              class="font-bold text-sm uppercase tracking-widest hover:text-mes-lime transition-colors"
              >Programa</a
            >
            <a href="#bustia" class="btn-primary text-xs">B√∫stia üì©</a>
          </div>
          <button id="mobile-btn" class="md:hidden text-2xl">‚ò∞</button>
        </div>
      </div>
      <div
        id="mobile-menu"
        class="hidden md:hidden bg-mes-dark text-white p-6 space-y-4"
      >
        <a href="#actualitat" class="block font-bold uppercase tracking-widest"
          >Actualitat</a
        >
        <a href="#visio" class="block font-bold uppercase tracking-widest"
          >Visi√≥</a
        >
        <a href="#programa" class="block font-bold uppercase tracking-widest"
          >Programa</a
        >
        <a
          href="#bustia"
          class="block font-bold uppercase tracking-widest text-mes-lime"
          >B√∫stia</a
        >
      </div>
    </nav>

    <!-- Hero -->
    <header class="pt-36 pb-20 bg-mes-gray">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="max-w-4xl">
          <div class="section-title-box">Projecte de futur</div>
          <h1
            class="text-5xl md:text-7xl font-extrabold leading-none mb-6 uppercase"
          >
            EL LLUCMAJOR <br /><span class="text-mes-lime bg-mes-dark px-2"
              >QUE TU VOLEMS</span
            >.
          </h1>
          <p class="text-xl text-stone-700 mb-8 font-medium max-w-2xl">
            Treballem per un municipi arrelat, sostenible i amb serveis dignes
            per a tots els nuclis, des de s'Arenal fins al centre.
          </p>
          <div class="flex flex-wrap gap-4">
            <a href="#programa" class="btn-primary text-lg px-8 py-4"
              >Consulta el Programa</a
            >
            <button
              onclick="toggleChat()"
              class="border-4 border-mes-dark px-8 py-4 font-extrabold uppercase text-lg tracking-widest hover:bg-mes-dark hover:text-white transition-all"
            >
              Assistent IA ‚ú®
            </button>
          </div>
        </div>
      </div>
    </header>

    <!-- Secci√≥ Actualitat -->
    <section id="actualitat" class="py-20">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div
          class="flex flex-col md:flex-row justify-between items-end mb-12 gap-6"
        >
          <div>
            <div class="section-title-box">Actualitat</div>
            <h2 class="text-4xl font-extrabold uppercase">Not√≠cies i Opini√≥</h2>
          </div>
          <div class="flex gap-2">
            <button
              onclick="filterNews('all')"
              class="news-filter active font-bold text-xs uppercase px-4 py-2 bg-mes-dark text-white"
              data-f="all"
            >
              Tot
            </button>
            <button
              onclick="filterNews('noticia')"
              class="news-filter font-bold text-xs uppercase px-4 py-2 bg-mes-gray hover:bg-mes-lime"
              data-f="noticia"
            >
              Not√≠cies
            </button>
            <button
              onclick="filterNews('opinio')"
              class="news-filter font-bold text-xs uppercase px-4 py-2 bg-mes-gray hover:bg-mes-lime"
              data-f="opinio"
            >
              Opini√≥
            </button>
          </div>
        </div>
        <div id="news-container" class="grid grid-cols-1 md:grid-cols-3 gap-8">
          <!-- Injected via JS -->
        </div>
      </div>
    </section>

    <!-- El Llucmajor que volem -->
    <section id="visio" class="py-20 bg-mes-dark text-white">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-16">
          <div
            class="bg-mes-lime text-mes-dark px-4 py-1 inline-block font-extrabold uppercase mb-4"
          >
            La nostra visi√≥
          </div>
          <h2 class="text-4xl md:text-5xl font-extrabold uppercase">
            Un municipi per a viure-hi
          </h2>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-12">
          <div class="border-l-4 border-mes-lime pl-6">
            <span class="text-4xl mb-4 block">üè†</span>
            <h3 class="text-2xl font-extrabold uppercase mb-4">
              Habitatge Digne
            </h3>
            <p class="text-stone-400 font-medium">
              Prioritzem l'acc√©s a l'habitatge per als joves i frenem
              l'especulaci√≥ als nostres barris.
            </p>
          </div>
          <div class="border-l-4 border-mes-lime pl-6">
            <span class="text-4xl mb-4 block">üå≥</span>
            <h3 class="text-2xl font-extrabold uppercase mb-4">
              Sostenibilitat
            </h3>
            <p class="text-stone-400 font-medium">
              Protegim el nostre entorn natural i apostam per una energia neta i
              de quil√≤metre zero.
            </p>
          </div>
          <div class="border-l-4 border-mes-lime pl-6">
            <span class="text-4xl mb-4 block">üó£Ô∏è</span>
            <h3 class="text-2xl font-extrabold uppercase mb-4">
              Cultura i Llengua
            </h3>
            <p class="text-stone-400 font-medium">
              Defensam la nostra identitat i feim costat al teixit associatiu i
              cultural del poble.
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Programa -->
    <section id="programa" class="py-20 bg-white">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-12">
          <div class="section-title-box">Programa Electoral</div>
          <h2 class="text-4xl font-extrabold uppercase">Prioritats d'acci√≥</h2>
        </div>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-16 items-center">
          <div class="bg-mes-gray p-8 text-center">
            <h3 class="text-lg font-bold uppercase mb-4 tracking-widest">
              Eixos de Pressupost
            </h3>
            <div class="chart-container">
              <canvas id="programChart"></canvas>
            </div>
          </div>
          <div class="space-y-4" id="axis-content">
            <!-- Injected via JS -->
          </div>
        </div>
      </div>
    </section>

    <!-- B√∫stia -->
    <section id="bustia" class="py-20 bg-mes-lime">
      <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="bg-mes-dark text-white p-8 md:p-12 shadow-2xl">
          <h2 class="text-3xl font-extrabold uppercase mb-4">
            B√∫stia de Suggeriments
          </h2>
          <p class="mb-8 text-mes-lime font-bold">
            Ajuda'ns a millorar el municipi amb les teves propostes.
          </p>
          <form id="contactForm" class="space-y-6 text-mes-dark">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <input
                type="text"
                placeholder="NOM"
                class="w-full p-4 font-bold outline-none"
                required
              />
              <input
                type="email"
                placeholder="CORREU"
                class="w-full p-4 font-bold outline-none"
                required
              />
            </div>
            <div class="relative">
              <textarea
                id="suggestion-text"
                placeholder="EL TEU SUGGERIMENT..."
                rows="4"
                class="w-full p-4 font-medium outline-none"
                required
              ></textarea>
              <button
                type="button"
                onclick="refineText()"
                class="absolute bottom-2 right-2 bg-mes-dark text-mes-lime px-3 py-1 text-xs font-bold uppercase hover:bg-black transition-colors"
              >
                Millorar amb IA ‚ú®
              </button>
            </div>
            <button
              type="submit"
              class="btn-primary w-full py-4 text-xl justify-center"
            >
              Enviar Proposta
            </button>
          </form>
          <div
            id="form-ok"
            class="hidden mt-6 text-center text-mes-lime font-bold text-xl uppercase animate-pulse"
          >
            Enviat correctament! Gr√†cies.
          </div>
        </div>
      </div>
    </section>

    <!-- AI Chat Window -->
    <div id="ai-chat-window" class="flex flex-col">
      <div class="bg-mes-dark p-4 text-white flex justify-between items-center">
        <span class="font-bold uppercase text-xs tracking-widest"
          >‚ú® Assistent M√âS</span
        >
        <button onclick="toggleChat()" class="text-mes-lime">‚úï</button>
      </div>
      <div
        id="chat-messages"
        class="flex-grow p-4 overflow-y-auto space-y-3 bg-stone-50 text-sm"
      >
        <div class="chat-bubble-ai p-3">
          Hola! Soc l'IA de M√âS per Llucmajor. En qu√® et puc ajudar sobre el
          nostre programa?
        </div>
      </div>
      <div class="p-3 border-t flex gap-2">
        <input
          type="text"
          id="chat-input"
          placeholder="Pregunta..."
          class="flex-grow border p-2 text-sm outline-none"
        />
        <button
          onclick="sendChatMessage()"
          class="bg-mes-dark text-mes-lime px-4 py-2 font-bold text-xs uppercase"
        >
          Envia
        </button>
      </div>
    </div>

    <!-- Floating Bubble -->
    <button
      onclick="toggleChat()"
      class="fixed bottom-6 right-6 w-14 h-14 bg-mes-dark border-4 border-mes-lime text-2xl rounded-full shadow-xl hover:scale-110 transition-transform z-50"
    >
      ‚ú®
    </button>

    <footer
      class="bg-mes-dark text-white/50 py-10 text-center text-[10px] uppercase font-bold tracking-widest"
    >
      ¬© 2025 M√âS per Llucmajor ¬∑ El futur √©s a les nostres mans
    </footer>

    <script>
      const apiKey = ""; // API Key automatitzada
      const model = "gemini-2.5-flash-preview-09-2025";

      // Dades
      const news = [
        {
          type: "noticia",
          title: "Exigim una millora de les freq√º√®ncies de bus a s'Arenal",
          date: "28 DES 2024",
          summary:
            "La connectivitat del municipi √©s una prioritat absoluta per a nosaltres.",
        },
        {
          type: "opinio",
          title: "Llucmajor no pot ser el pati del darrere de Palma",
          date: "15 DES 2024",
          summary: "Article d'opini√≥ sobre el model urban√≠stic i tur√≠stic.",
        },
        {
          type: "noticia",
          title: "Assemblea oberta: Presentaci√≥ del programa 2025",
          date: "10 DES 2024",
          summary:
            "Volem un programa participatiu i obert a tota la ciutadania.",
        },
      ];

      const axis = {
        social: [
          "Habitatge jove assequible.",
          "Gratu√Øtat de l'etapa 0-3 anys.",
          "Refor√ß de Serveis Socials.",
        ],
        eco: [
          "Protecci√≥ del s√≤l r√∫stic.",
          "Autoconsum energ√®tic municipal.",
          "Millora del reciclatge.",
        ],
        governan√ßa: [
          "Pressupostos participatius reals.",
          "Transpar√®ncia en la gesti√≥.",
          "Consell de Barri a s'Arenal.",
        ],
      };

      // API Call Helper
      async function askGemini(prompt, system = "") {
        const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${apiKey}`;
        const body = {
          contents: [{ parts: [{ text: prompt }] }],
          systemInstruction: { parts: [{ text: system }] },
        };

        for (let i = 0; i < 5; i++) {
          try {
            const response = await fetch(url, {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify(body),
            });
            const data = await response.json();
            return (
              data.candidates?.[0]?.content?.parts?.[0]?.text ||
              "Ho sento, ha hagut un problema."
            );
          } catch (e) {
            await new Promise((r) => setTimeout(r, Math.pow(2, i) * 1000));
          }
        }
        return "Error de connexi√≥.";
      }

      // L√≤gica Not√≠cies
      function renderNews(filter = "all") {
        const container = document.getElementById("news-container");
        container.innerHTML = "";
        const filtered =
          filter === "all" ? news : news.filter((n) => n.type === filter);
        filtered.forEach((n) => {
          container.innerHTML += `
                <div class="bg-mes-gray p-6 border-b-4 border-transparent hover:border-mes-lime transition-all h-full flex flex-col">
                    <div class="flex justify-between text-[10px] font-bold mb-4 uppercase text-stone-400">
                        <span class="bg-mes-dark text-white px-2 py-0.5">${n.type}</span>
                        <span>${n.date}</span>
                    </div>
                    <h3 class="text-xl font-extrabold uppercase mb-4 flex-grow">${n.title}</h3>
                    <p class="text-sm text-stone-600 mb-6">${n.summary}</p>
                    <a href="#" class="text-xs font-bold uppercase border-b-2 border-mes-lime self-start">Llegir m√©s</a>
                </div>`;
        });
      }

      function filterNews(f) {
        document.querySelectorAll(".news-filter").forEach((b) => {
          b.classList.toggle("bg-mes-dark", b.dataset.f === f);
          b.classList.toggle("text-white", b.dataset.f === f);
        });
        renderNews(f);
      }

      // IA Chat
      function toggleChat() {
        const chat = document.getElementById("ai-chat-window");
        chat.style.display = chat.style.display === "flex" ? "none" : "flex";
      }

      async function sendChatMessage() {
        const input = document.getElementById("chat-input");
        const box = document.getElementById("chat-messages");
        if (!input.value) return;

        const text = input.value;
        box.innerHTML += `<div class="chat-bubble-user p-3">${text}</div>`;
        input.value = "";
        box.scrollTop = box.scrollHeight;

        const loading = document.createElement("div");
        loading.className = "chat-bubble-ai p-3 loading-dots";
        loading.innerText = "Pensant";
        box.appendChild(loading);

        const sys =
          "Ets l'assistent de M√âS per Llucmajor. Respon en catal√†, de forma propera i progressista. Coneixes el nostre programa: habitatge, sostenibilitat, cultura mallorquina i descentralitzaci√≥ de serveis.";
        const resp = await askGemini(text, sys);

        loading.classList.remove("loading-dots");
        loading.innerText = resp;
        box.scrollTop = box.scrollHeight;
      }

      // Millorar Suggeriment
      async function refineText() {
        const area = document.getElementById("suggestion-text");
        if (!area.value) return;
        const original = area.value;
        area.value = "Refinant proposta amb IA...";
        const resp = await askGemini(
          `Reescriu el seg√ºent suggeriment d'un ciutad√† perqu√® sigui m√©s formal i constructiu, mantenint la idea: "${original}"`,
          "Ets un redactor de propostes pol√≠tiques municipals. Respon nom√©s amb el text reescrit."
        );
        area.value = resp;
      }

      // Init
      window.onload = () => {
        renderNews();
        // Gr√†fic
        const ctx = document.getElementById("programChart").getContext("2d");
        new Chart(ctx, {
          type: "doughnut",
          data: {
            labels: ["SOCIAL", "ECOLOGIA", "CULTURA", "GOVERN"],
            datasets: [
              {
                data: [40, 30, 20, 10],
                backgroundColor: ["#c6d100", "#1a1a1a", "#888888", "#dddddd"],
                borderWidth: 0,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { position: "bottom" } },
          },
        });
        // Programa eixos
        const axisBox = document.getElementById("axis-content");
        Object.keys(axis).forEach((k) => {
          axisBox.innerHTML += `
                <div class="bg-mes-gray p-4 border-l-4 border-mes-lime">
                    <h4 class="font-bold uppercase text-xs mb-2 text-mes-lime">${k}</h4>
                    <ul class="text-sm font-bold space-y-1">
                        ${axis[k].map((i) => `<li>‚Ä∫ ${i}</li>`).join("")}
                    </ul>
                </div>`;
        });

        document.getElementById("mobile-btn").onclick = () =>
          document.getElementById("mobile-menu").classList.toggle("hidden");
        document.getElementById("contactForm").onsubmit = (e) => {
          e.preventDefault();
          document.getElementById("contactForm").classList.add("hidden");
          document.getElementById("form-ok").classList.remove("hidden");
        };
      };
    </script>
  </body>
</html>
